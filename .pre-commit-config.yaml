# ===== FLEXT STANDARDS - PRE-COMMIT CONFIGURATION =====
# ==============================================================
# Zero Tolerance Pre-Commit Hooks - FLEXT Standard 2025
# All tools configured in pyproject.toml for single source of truth
# Based on Python 3.13 + bleeding-edge tools with maximum strictness

repos:
  # ===== METADATA & STRUCTURE VALIDATION =====
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
        name: "ğŸ§¹ Remove trailing whitespace"
      - id: end-of-file-fixer
        name: "ğŸ“ Fix end of files"
      - id: check-yaml
        name: "âœ… Validate YAML files"
      - id: check-json
        name: "âœ… Validate JSON files"
      - id: check-toml
        name: "âœ… Validate TOML files"
      - id: check-xml
        name: "âœ… Validate XML files"
      - id: check-merge-conflict
        name: "ğŸ” Check for merge conflicts"
      - id: check-case-conflict
        name: "ğŸ” Check for case conflicts"
      - id: check-symlinks
        name: "ğŸ” Check for broken symlinks"
      - id: destroyed-symlinks
        name: "ğŸ” Check for destroyed symlinks"
      - id: check-executables-have-shebangs
        name: "ğŸ” Check executables have shebangs"
      - id: check-shebang-scripts-are-executable
        name: "ğŸ” Check shebang scripts are executable"
      - id: mixed-line-ending
        name: "ğŸ” Check for mixed line endings"
        args: ["--fix=lf"]
      - id: check-byte-order-marker
        name: "ğŸ” Check for byte order marker"
      - id: check-ast
        name: "ğŸ” Check Python AST"
      - id: check-builtin-literals
        name: "ğŸ” Check builtin type constructor use"
      - id: check-docstring-first
        name: "ğŸ” Check docstring is first"
      - id: debug-statements
        name: "ğŸ” Check for debugger imports"
      - id: name-tests-test
        name: "ğŸ” Check test file naming"
      - id: requirements-txt-fixer
        name: "ğŸ“¦ Fix requirements.txt"
      - id: fix-byte-order-marker
        name: "ğŸ”§ Fix byte order marker"
      - id: pretty-format-json
        name: "ğŸ¨ Format JSON files"
        args: ["--autofix", "--indent=2"]

  # ===== PYTHON CODE FORMATTING =====
  - repo: https://github.com/psf/black
    rev: 24.10.0
    hooks:
      - id: black
        name: "ğŸ¨ Format Python code (Black)"
        language_version: python3.13
        args: ["--config=pyproject.toml"]
        types: [python]

  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        name: "ğŸ“¦ Sort Python imports (isort)"
        args: ["--settings-path=pyproject.toml"]
        types: [python]

  # ===== PYTHON CODE QUALITY & LINTING =====
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.8.6
    hooks:
      - id: ruff
        name: "ğŸ”¬ Lint Python code (Ruff)"
        args: ["--config=pyproject.toml", "--fix"]
        types: [python]
      - id: ruff-format
        name: "ğŸ¨ Format Python code (Ruff)"
        args: ["--config=pyproject.toml"]
        types: [python]

  # ===== TYPE CHECKING =====
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.13.0
    hooks:
      - id: mypy
        name: "ğŸ” Type checking (MyPy)"
        args: ["--config-file=pyproject.toml", "--strict"]
        language_version: python3.13
        additional_dependencies: 
          - types-requests
          - types-setuptools
          - types-python-dateutil
          - types-tabulate
        types: [python]
        exclude: ^(docs/|scripts/|tests/fixtures/)

  # ===== SECURITY SCANNING =====
  - repo: https://github.com/PyCQA/bandit
    rev: 1.8.6
    hooks:
      - id: bandit
        name: "ğŸ›¡ï¸ Security scan (Bandit)"
        args: ["-c", "pyproject.toml", "-r", "src/"]
        types: [python]
        exclude: ^tests/

  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.5.0
    hooks:
      - id: detect-secrets
        name: "ğŸ” Detect secrets"
        args: ["--baseline", ".secrets.baseline"]
        exclude: ^(tests/fixtures/|.*\.lock$|poetry\.lock$)

  # ===== DOCUMENTATION =====
  - repo: https://github.com/adamchainz/blacken-docs
    rev: 1.19.1
    hooks:
      - id: blacken-docs
        name: "ğŸ¨ Format code in docs (blacken-docs)"
        additional_dependencies: [black]
        language_version: python3.13

  - repo: https://github.com/econchick/interrogate
    rev: 1.7.0
    hooks:
      - id: interrogate
        name: "ğŸ“š Check docstring coverage"
        args: ["--config=pyproject.toml"]
        types: [python]
        exclude: ^(tests/|docs/|scripts/)

  # ===== SPELL CHECKING =====
  - repo: https://github.com/codespell-project/codespell
    rev: v2.4.1
    hooks:
      - id: codespell
        name: "ğŸ“ Check spelling (codespell)"
        args: ["--config=pyproject.toml"]
        exclude: ^(poetry\.lock$|.*\.min\.(js|css)$|.*\.map$)

  # ===== PYTHON UPGRADES =====
  - repo: https://github.com/asottile/pyupgrade
    rev: v3.18.0
    hooks:
      - id: pyupgrade
        name: "â¬†ï¸ Upgrade Python syntax"
        args: ["--py313-plus"]
        language_version: python3.13
        types: [python]

  # ===== YAML & TOML FORMATTING =====
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
        name: "ğŸ¨ Format YAML/JSON/Markdown"
        types_or: [yaml, json, markdown]
        exclude: ^(poetry\.lock$|.*\.min\.(js|css)$)

  # ===== DEPENDENCY SCANNING =====
  - repo: https://github.com/Lucas-C/pre-commit-hooks-safety
    rev: v1.3.3
    hooks:
      - id: python-safety-dependencies-check
        name: "ğŸ” Check dependencies for vulnerabilities"
        args: ["--ignore=70612"]  # Ignore jinja2 vulnerability in development

  # ===== COMMIT STANDARDS =====
  - repo: https://github.com/commitizen-tools/commitizen
    rev: v3.31.0
    hooks:
      - id: commitizen
        name: "ğŸ“ Check commit message format"
        stages: [commit-msg]

  # ===== DOCKERFILE LINTING =====
  - repo: https://github.com/hadolint/hadolint
    rev: v2.12.0
    hooks:
      - id: hadolint-docker
        name: "ğŸ³ Lint Dockerfile"
        files: Dockerfile.*
        args: ["--config", ".hadolint.yaml"]

  # ===== SHELL SCRIPT LINTING =====
  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.10.0.1
    hooks:
      - id: shellcheck
        name: "ğŸ” Lint shell scripts"
        types: [shell]
        args: ["--severity=warning"]

  # ===== GITHUB ACTIONS VALIDATION =====
  - repo: https://github.com/python-jsonschema/check-jsonschema
    rev: 0.33.2
    hooks:
      - id: check-github-workflows
        name: "âœ… Validate GitHub workflows"
        files: ^\.github/workflows/.*\.ya?ml$
      - id: check-dependabot
        name: "âœ… Validate Dependabot config"
        files: ^\.github/dependabot\.ya?ml$

  # ===== MAKEFILE LINTING =====
  - repo: https://github.com/mrtazz/checkmake
    rev: 0.2.2
    hooks:
      - id: checkmake
        name: "ğŸ” Lint Makefile"
        files: ^Makefile$

  # ===== FINAL VALIDATION =====
  - repo: local
    hooks:
      - id: poetry-check
        name: "ğŸ“¦ Validate Poetry configuration"
        entry: poetry check
        language: system
        files: ^pyproject\.toml$
        pass_filenames: false
      
      - id: poetry-lock-check
        name: "ğŸ”’ Check Poetry lock file"
        entry: poetry lock --check
        language: system
        files: ^(pyproject\.toml|poetry\.lock)$
        pass_filenames: false

# ===== CONFIGURATION =====
default_stages: [pre-commit]
default_language_version:
  python: python3.13

# ===== CI INTEGRATION =====
ci:
  autofix_commit_msg: |
    ğŸ”§ auto-fix(pre-commit): apply automatic fixes
    
    [skip ci]
  autofix_prs: true
  autoupdate_branch: ''
  autoupdate_commit_msg: 'ğŸ”„ chore(deps): update pre-commit hooks'
  autoupdate_schedule: weekly
  skip:
    - mypy  # Skip MyPy in CI as it's run separately
    - interrogate  # Skip docstring check in CI
    - python-safety-dependencies-check  # Skip safety in CI as it's run separately

# ===== FLEXT STANDARDS COMPLIANCE =====
# This configuration ensures:
# âœ… Zero tolerance for code quality issues
# âœ… Maximum security scanning
# âœ… Complete documentation coverage
# âœ… Bleeding-edge tool versions
# âœ… Python 3.13 compatibility
# âœ… All configurations centralized in pyproject.toml
# âœ… Enterprise-grade standards